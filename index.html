<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Interactive Digital Coin - Lord Remys</title>
    <style>
        html, body { overflow: hidden; width: 100%; height: 100%; margin: 0; padding: 0; }
        #renderCanvas { width: 100%; height: 100%; touch-action: none; }
        #email-form { position: absolute; top: 10px; right: 10px; background: rgba(255,255,255,0.8); padding: 10px; border-radius: 5px; z-index: 10; }
    </style>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <!-- Replace YOUR_TRACKING_ID -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=YOUR_TRACKING_ID"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'YOUR_TRACKING_ID');
    </script>
</head>
<body>
    <canvas id="renderCanvas"></canvas>
    <div id="email-form">
        <form action="https://formspree.io/f/yourid" method="POST">
            <label>Subscribe for updates:</label><br>
            <input type="email" name="email" placeholder="Your email" required>
            <button type="submit">Submit</button>
        </form>
    </div>
    <script type="text/javascript">
        var canvas = document.getElementById("renderCanvas");
        var engine = new BABYLON.Engine(canvas, true);

        function createScene() {
            var scene = new BABYLON.Scene(engine);

            // Base lighting unchanged
            scene.environmentTexture = new BABYLON.CubeTexture("https://assets.babylonjs.com/environments/studio.env", scene);
            scene.environmentIntensity = 1.8;

            var dirLight = new BABYLON.DirectionalLight("dirLight", new BABYLON.Vector3(0.5, -0.5, -1), scene);
            dirLight.intensity = 0.9;
            dirLight.diffuse = new BABYLON.Color3(1, 0.98, 0.9);
            dirLight.specular = new BABYLON.Color3(0.6, 0.6, 0.6);

            // NEW: Subtle back fill to brighten upright back face (opposite angle, low intensity)
            var backFill = new BABYLON.DirectionalLight("backFill", new BABYLON.Vector3(-0.5, 0.5, 1), scene); // Aimed toward back
            backFill.intensity = 0.6; // Gentle lift
            backFill.diffuse = new BABYLON.Color3(1, 0.95, 0.85); // Warm
            backFill.specular = new BABYLON.Color3(0.3, 0.3, 0.3);

            // Camera
            var camera = new BABYLON.ArcRotateCamera("camera", Math.PI / 2, Math.PI / 4, 6, BABYLON.Vector3.Zero(), scene);
            camera.attachControl(canvas, true);
            camera.lowerRadiusLimit = 3;
            camera.upperRadiusLimit = 12;

            // Coin
            var coin = new BABYLON.TransformNode("coin", scene);

            // Reeded edge - try inverted bump + adjusted scaling for vertical grooves
            var side = BABYLON.MeshBuilder.CreateCylinder("side", {height: 0.12, diameter: 4, tessellation: 128, cap: BABYLON.Mesh.NO_CAP}, scene);
            var sideMat = new BABYLON.PBRMaterial("sideMat", scene);
            sideMat.albedoColor = new BABYLON.Color3(0.95, 0.80, 0.55);
            sideMat.metallic = 1.0;
            sideMat.roughness = 0.12;
            sideMat.emissiveColor = new BABYLON.Color3(0.06, 0.05, 0.02); // Glow to make grooves visible
            sideMat.bumpTexture = new BABYLON.Texture("edge_normal.png", scene);
            sideMat.bumpTexture.rotation = 0; // Changed to 0 - test this first; try Math.PI / 2 or Math.PI if grooves wrong direction
            sideMat.bumpTexture.uScale = 0.6; // Less repeat around circumference
            sideMat.bumpTexture.vScale = 140; // Very dense along height for fine vertical ridges
            sideMat.bumpTexture.level = -2.0; // Negative to invert bump (raised â†’ depressed or vice versa - often fixes visibility)
            side.material = sideMat;
            side.parent = coin;

            // Front - tighter radius + stronger gold fill
            var front = BABYLON.MeshBuilder.CreateDisc("front", {radius: 1.85, tessellation: 128}, scene);
            var frontMat = new BABYLON.PBRMaterial("frontMat", scene);
            frontMat.albedoTexture = new BABYLON.Texture("Front.png", scene);
            frontMat.albedoTexture.uScale = -1;
            frontMat.albedoColor = new BABYLON.Color3(0.99, 0.87, 0.65); // Very strong warm gold fallback
            frontMat.metallic = 1.0;
            frontMat.roughness = 0.18;
            frontMat.backFaceCulling = false;
            front.material = frontMat;
            front.position.y = 0.06;
            front.rotation.x = Math.PI / 2;
            front.parent = coin;

            // Back - same
            var back = BABYLON.MeshBuilder.CreateDisc("back", {radius: 1.85, tessellation: 128}, scene);
            var backMat = new BABYLON.PBRMaterial("backMat", scene);
            backMat.albedoTexture = new BABYLON.Texture("Back.png", scene);
            backMat.albedoTexture.uScale = -1;
            backMat.albedoTexture.vScale = -1;
            backMat.albedoColor = new BABYLON.Color3(0.99, 0.87, 0.65); // Strong gold fill
            backMat.metallic = 1.0;
            backMat.roughness = 0.18;
            backMat.backFaceCulling = false;
            back.material = backMat;
            back.position.y = -0.06;
            back.rotation.x = Math.PI / 2;
            back.parent = coin;

            // Spin
            var spinSpeed = 0.4;
            scene.registerBeforeRender(function () {
                if (!camera.inertialAlphaOffset && !camera.inertialBetaOffset && !camera.inertialRadiusOffset) {
                    coin.rotation.y += BABYLON.Tools.ToRadians(spinSpeed) * engine.getDeltaTime() / 1000;
                }
            });

            return scene;
        }

        var scene = createScene();
        engine.runRenderLoop(function () { scene.render(); });
        window.addEventListener("resize", function () { engine.resize(); });
    </script>
</body>
</html>
